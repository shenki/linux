// SPDX-License-Identifier: GPL-2.0-or-later

/dts-v1/;

#include "aspeed-g7.dtsi"
#include <dt-bindings/gpio/aspeed-gpio.h>

/ {
	model = "AST2700 FPGA";
	compatible = "aspeed,ast2700-fpga", "aspeed,ast2700";

	chosen {
		bootargs = "console=ttyS12,115200n8";
		stdout-path = &uart12;
	};

	firmware {
		optee: optee {
			compatible = "linaro,optee-tz";
			method = "smc";
		};
	};

	memory@400000000 {
		device_type = "memory";
		reg = <0x4 0x00000000 0x0 0x0c000000>;
	};

	reserved-memory {
		#address-cells = <2>;
		#size-cells = <2>;
		ranges;

		bmc_dev_memory: bmc_dev_memory {
			size = <0x0 0x00100000>;
			alignment = <0x0 0x00100000>;
			compatible = "shared-dma-pool";
			no-map;
		};

	};
};

&uart4 {
	status = "okay";
};

&uart12 {
	clock-frequency = <1846154>;
	status = "okay";
};

&fmc {
	status = "okay";
	flash@0 {
		status = "okay";
		m25p,fast-read;
		label = "bmc";
		spi-rx-bus-width = <4>;
		spi-max-frequency = <50000000>;
#include "fpga-flash-layout.dtsi"
	};

	flash@1 {
		status = "disabled";
		m25p,fast-read;
		label = "fmc0:1";
		spi-max-frequency = <50000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
	};

	flash@2 {
		status = "disabled";
		m25p,fast-read;
		label = "fmc0:2";
		spi-max-frequency = <50000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
	};
};

&emmc_controller {
	status = "okay";
	mmc-hs200-1_8v;
};

&emmc {
	status = "okay";
#if 1
	bus-width = <4>;
#else
	bus-width = <8>;
	pinctrl-0 = <&pinctrl_emmc_default
			&pinctrl_emmcg8_default>;
#endif
	non-removable;
	max-frequency = <100000000>;
};

&spi0 {
	fmc-spi-user-mode;
	status = "okay";

	flash@0 {
		status = "okay";
		m25p,fast-read;
		label = "spi1:0";
		spi-max-frequency = <50000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
	};

	flash@1 {
		status = "disabled";
		m25p,fast-read;
		label = "spi1:1";
		spi-max-frequency = <50000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
	};
};

&spi1 {
	fmc-spi-user-mode;
	status = "okay";

	flash@0 {
		status = "okay";
		m25p,fast-read;
		label = "spi2:0";
		spi-max-frequency = <50000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
	};

	flash@1 {
		status = "disabled";
		m25p,fast-read;
		label = "spi2:1";
		spi-max-frequency = <50000000>;
		spi-tx-bus-width = <4>;
		spi-rx-bus-width = <4>;
	};
};

&mdio0 {
	status = "okay";
	#address-cells = <1>;
	#size-cells = <0>;

	ethphy0: ethernet-phy@0 {
		compatible = "ethernet-phy-ieee802.3-c22";
		reg = <0>;
	};
};

&mac0 {
	status = "okay";

	phy-mode = "rgmii-rxid";
	phy-handle = <&ethphy0>;
};

&i2c0 {
	status = "okay";
};

&rtc {
	status = "okay";
};

#if 0
&bmc_dev0 {
	status = "okay";
	memory-region = <&bmc_dev_memory>;
};

&pcie0_vuart0 {
	port = <0x3f8>;
	sirq = <4>;
	sirq-polarity = <0>;

	status = "okay";
};

&pcie0_vuart1 {
	port = <0x2f8>;
	sirq = <3>;
	sirq-polarity = <0>;

	status = "okay";
};

&pcie0_kcs0 {
	aspeed,lpc-io-reg = <0x3a0>, <0x3a1>;

	status = "okay";
};

&pcie0_kcs1 {
	aspeed,lpc-io-reg = <0x3a8>, <0x3a9>;

	status = "okay";
};

&pcie0_kcs2 {
	aspeed,lpc-io-reg = <0x3a2>;

	status = "okay";
};

&pcie0_kcs3 {
	aspeed,lpc-io-reg = <0x3a4>, <0x3a5>;

	status = "okay";
};

&pcie0_ibt {
	status = "okay";
};

#endif
